# DailyReportApp-database-lecture_ver-
これは東京都市大学における講義「データベース」で提出する課題を格納したリポジトリです。

チーム内のコミュニケーション活性化と、メンバーのコンディション（SOS）の早期発見を目的とした日報共有アプリケーションです。

## メンバー(チーム名:夜行性)
- 渡邉 諒（2442102）
- 田中 誠真（2442054）

## 📖 アプリケーション概要

ユーザーは日々の業務内容（日報）を投稿し、他者の日報に対してコメントやタグ付けを行うことができます。
単なる記録だけでなく、**「調子（SOS/絶好調など）」を登録することで、管理者がチームの状態を定量的に把握できるランキング・集計機能**を備えています。

## 🛠 使用技術 (Tech Stack)

本アプリケーションは、Dockerコンテナ上で構築されています。

* **開発言語**: Python 3.11
* **フレームワーク**: Django 5.0
* **データベース**: PostgreSQL 15
* **インフラ**: Docker / Docker Compose
* **フロントエンド**: HTML5 / CSS3 (レスポンシブ対応)

## 💡 データベース講義における実装ポイント

本課題では、リレーショナルデータベースの機能を効率的に利用するため、以下の技術的な工夫を行いました。

### 1. N+1問題の解消とパフォーマンス最適化

一覧画面における大量のデータベースアクセスを防ぐため、DjangoのORM機能を活用してクエリ数を削減しました。

* `select_related`: 外部キー（User, Category）の結合に使用。
* `prefetch_related`: 多対多関係（Tags, Comments）の事前取得に使用。

### 2. 集計関数と高度なクエリ (Aggregation)

Python側でのループ処理ではなく、データベースエンジン側での集計を行いました。

* **活動ランキング**: `annotate` と `Count` を使用し、投稿数をユーザーごとに集計。
* **SOS検知**: `filter=Q(...)` を用いた条件付き集計を行い、特定の条件（SOS）のみをカウント。

### 3. トランザクション制御 (ACID特性)

日報の投稿処理において `transaction.atomic()` を使用し、記事保存とタグ保存の整合性を担保しています（原子性の保証）。

### 4. 検索機能 (WHERE / LIKE句)

`Qオブジェクト` を使用し、タイトルと本文を対象としたAND/OR検索（あいまい検索）およびカテゴリーによる絞り込みを実装しました。

## ✨ アプリケーション機能一覧 (Features)

### 1. ユーザー機能

一般ユーザーが利用するメインの機能群です。

* **日報のCRUD機能（作成・参照・更新・削除）**
* その日の業務内容だけでなく、**「調子（コンディション）」**を5段階で登録可能。
* 画像アップロードに対応し、視覚的な報告が可能。
* 他者の日報に対するコメント投稿機能。


* **高度な検索・フィルタリング**
* キーワード検索（タイトル・本文）とカテゴリー絞り込みを組み合わせた検索が可能。
* 過去のナレッジや、特定の話題（例：「エラー」「技術共有」）を即座に抽出できます。


* **活動分析ダッシュボード**
* **貢献度ランキング**: 日報の投稿数を集計し、アクティブなメンバーを可視化。
* **SOSアラート**: 「調子が悪いです（SOS）」と申告しているメンバーを自動抽出し、管理者が早期ケアを行えるように一覧表示。



### 2. 管理者機能 (Django Admin)

URL: `/admin/`

本アプリケーションは、Django標準の強力な管理画面を有効化しています。
データベースの専門知識がない管理者でも、ブラウザ上から以下の操作が安全に行えます。

* **ユーザー管理**: アカウントの追加・削除、パスワードリセット、権限設定。
* **マスターデータ管理**: 日報の「カテゴリー」や「タグ」の追加・修正。
* **コンテンツ管理**: 不適切な投稿やコメントの削除、データの修正。
* **データ確認**: 登録されている全データをテーブル形式で閲覧・検索可能。

## 🚀 環境構築と起動方法 (Setup)

Dockerがインストールされている環境であれば、以下のコマンドですぐに動作確認が可能です。

### 1. リポジトリのクローン

```bash
git clone https://github.com/あなたのユーザー名/DailyReportApp-database-lecture_ver-.git
cd DailyReportApp-database-lecture_ver-

```

### 2. コンテナのビルドと起動

```bash
docker-compose up -d --build

```

### 3. データベースのセットアップ（マイグレーション）

初回起動時はテーブルを作成する必要があります。

```bash
docker-compose exec web python manage.py migrate

```

### 4. 初期データのロード（推奨）

テスト用のユーザー、カテゴリー、サンプル記事を一括で登録します。

```bash
docker-compose exec web python manage.py loaddata initial_data.json

```

### 5. アプリケーションへのアクセス

ブラウザで以下のURLにアクセスしてください。
http://localhost:8000

## 🔑 テスト用アカウント

初期データをロードした場合、以下のアカウントでログイン可能です。

| 権限 | ユーザー名 | パスワード | 用途 |
| --- | --- | --- | --- |
| **管理者** | `admin` | `skyblock` | 管理画面へのアクセス、全操作 |
| **一般** | `tanaka` | `skyblock` | 日報投稿、コメントのテスト用 |
| **一般** | `suzuki` | `skyblock` | SOS投稿のテスト用 |

---

## 📂 ディレクトリ構成

```
.
├── accounts/       # ユーザー認証・管理機能
├── config/         # Djangoプロジェクト設定
├── reports/        # 日報アプリのメイン機能 (Model, View, Template)
├── media/          # ユーザーアップロード画像 (Git管理外)
├── docker-compose.yml
├── Dockerfile
├── manage.py
└── requirements.txt

```